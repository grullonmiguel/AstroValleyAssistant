<Window x:Class="AstroValleyAssistant.Views.MainView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:AstroValleyAssistant"
        xmlns:views="clr-namespace:AstroValleyAssistant.Views"
        xmlns:viewmodels="clr-namespace:AstroValleyAssistant.ViewModels"
        xmlns:viewDialogs="clr-namespace:AstroValleyAssistant.Views.Dialogs"
        xmlns:dialogs="clr-namespace:AstroValleyAssistant.ViewModels.Dialogs"
        Title="Astro Valley Assistant"
        Height="768" Width="1024"
        MinHeight="480" MinWidth="640"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <DataTemplate DataType="{x:Type viewmodels:RegridViewModel}">
            <views:RegridView/>
        </DataTemplate>
        <DataTemplate DataType="{x:Type viewmodels:RealAuctionViewModel}">
            <views:RealAuctionView/>
        </DataTemplate>
        <DataTemplate DataType="{x:Type viewmodels:MapViewModel}">
            <views:MapView/>
        </DataTemplate>
        <DataTemplate DataType="{x:Type dialogs:CountyMapDialogViewModel}">
            <viewDialogs:CountyMapView/>
        </DataTemplate>
        <DataTemplate DataType="{x:Type dialogs:RealAuctionSettingsViewModel}">
            <viewDialogs:RealAuctionSettingsView/>
        </DataTemplate>
        <DataTemplate DataType="{x:Type dialogs:RegridSettingsViewModel}">
            <viewDialogs:RegridSettingsView/>
        </DataTemplate>
        <DataTemplate DataType="{x:Type dialogs:ThemeSettingsViewModel}">
            <viewDialogs:ThemeSettingsView/>
        </DataTemplate>
    </Window.Resources>

    <Grid Background="{DynamicResource Brush.Background.Primary}">
        <DockPanel>
            <!-- Header -->
            <Border Style="{StaticResource Theme.Border.Header}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <!-- Logo -->
                    <ContentControl Grid.Column="0" Style="{StaticResource AppLogo}"/>

                    <!-- Navigation Buttons: Regrid | Real Auction | Maps | Menu  -->
                    <StackPanel Grid.Column="2" Orientation="Horizontal">
                        <RadioButton Content="Regrid" Command="{Binding NavigateCommand}" CommandParameter="Regrid" Style="{StaticResource Theme.RadioButton.HeaderLink}"/>
                        <RadioButton Content="Real Auction" Command="{Binding NavigateCommand}" CommandParameter="RealAuction" Style="{StaticResource Theme.RadioButton.HeaderLink}"/>
                        <RadioButton Content="Maps" Command="{Binding NavigateCommand}" CommandParameter="Map" IsChecked="True" Style="{StaticResource Theme.RadioButton.HeaderLink}"/>
                        <Button x:Name="HamburgerMenuButton" Command="{Binding OpenMenuCommand}" Style="{StaticResource Theme.Button.HamburgerMenu}" />
                        <Popup
                            PlacementTarget="{Binding ElementName=HamburgerMenuButton}"
                            IsOpen="{Binding IsMenuOpen}"
                            StaysOpen="False"
                            AllowsTransparency="True">
                            <Border CornerRadius="5"
                                    Background="{DynamicResource Brush.Accent}">
                                <StackPanel>
                                    <Button Command="{Binding OpenDrawerCommand}" CommandParameter="OptionRealAuction" Content="Real Auction" Background="Transparent" Width="200" Margin="2 1" HorizontalContentAlignment="Left" Padding="8 2"/>
                                    <Button Command="{Binding OpenDrawerCommand}" CommandParameter="OptionRegrid" Content="Regrid" Background="Transparent" Width="200" Margin="2 1" HorizontalContentAlignment="Left" Padding="8 2"/>
                                    <Button Command="{Binding OpenDrawerCommand}" CommandParameter="OptionThemes" Content="Theme" Background="Transparent" Width="200" Margin="2 1" HorizontalContentAlignment="Left" Padding="8 2"/>
                                </StackPanel>
                            </Border>
                        </Popup>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Content -->
            <ContentControl Content="{Binding CurrentViewModel}" Margin="{StaticResource Margin.Page}" />
            
        </DockPanel>

        <!-- Left/Top Accent Lines -->
        <ContentControl Style="{StaticResource Theme.Decorator.AccentOverlay}"/>
        
        <!-- Dialog Host -->
        <Grid Background="{DynamicResource Brush.Background.Dialog}" 
              Visibility="{Binding CurrentDialogViewModel, Converter={StaticResource NullToVisibilityConverter}}">
            <ContentControl 
                Style="{StaticResource Theme.ContentControl.DialogWindow}"
                Content="{Binding CurrentDialogViewModel}" 
                Visibility="{Binding CurrentDialogViewModel, Converter={StaticResource NullToVisibilityConverter}}"/>
        </Grid>

        <!-- Drawer Dialog Host (Right Side) -->
        <Grid Background="{DynamicResource Brush.Background.Dialog}" 
              Visibility="{Binding CurrentDrawerViewModel, Converter={StaticResource NullToVisibilityConverter}}">
            <ContentControl 
                Style="{StaticResource Theme.ContentControl.DrawerPanel}"
                Content="{Binding CurrentDrawerViewModel}"
                HorizontalAlignment="Right" 
                Visibility="{Binding CurrentDrawerViewModel, Converter={StaticResource NullToVisibilityConverter}}"/>
        </Grid>
    </Grid>
</Window>